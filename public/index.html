<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="Quality of Life Dashboard.">
    <meta name="keywords" content="GIS,Mecklenburg County,parks,libraries,schools,environment,impervious surface,floodplain,zoning,assessment,tax,photos,government">
    <meta name="author" content="Tobin Bradley">

    <!-- Set the title here -->
    <title>Quality of Life Dashboard</title>

    <!-- Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/png" href="images/favicon.png" />
    <link rel="apple-touch-icon-precomposed" href="images/apple-touch-icon-precomposed.png" />

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/main.css?foo=95049">

</head>

<body>
    <!--[if lt IE 9]>
        <p class="oldie alert-info text-center">You are using an outdated browser. <a href="http://whatbrowser.org/">Upgrade your browser today</a> to better experience this site.</p>
    <![endif]-->
    <div class="jumbotron">
      <div class="container">
          <h1>Quality of Life Dashboard</h1>
          <p>
              Assessing the quality of life in neighborhoods through their character, economics, education, engagment,
              environment, health, housing, and safety.
          </p>
          <p>
              <a href="http://qol.charmeck.org/" class="btn btn-primary btn-lg" role="button">Learn more</a>
              <a href="javascript:void(0)" class="btn btn-primary btn-lg scrollToStart" role="button">Get started</a>
          </p>
      </div>
    </div>
    <nav class="navbar navbar-default navbar-main" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="./">Quality of Life Dashboard</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="javascript:void(0)" class="scrollToStart">About</a>
                    </li>
                    <li>
                        <a href="javascript:void(0)">Get Data</a>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" href="javascript:void(0)" data-toggle="dropdown">Contact <span class="caret"></span></a>
                        <div class="dropdown-menu contact">
                            <form action="" method="post" accept-charset="UTF-8">
                                <label for="email" class="sr-only">input email address</label>
                                <input id="email" class="form-control" type="email" name="email" size="30" placeholder="Email Address (optional)" />
                                <label for="message" class="sr-only">your message</label>
                                <textarea id="message" name="message" class="form-control" rows="3" placeholder="Message"></textarea>
                                <input class="btn btn-primary" style="clear: left; width: 100%; height: 32px; font-size: 13px;" type="submit" name="commit" value="Send" />
                            </form>
                        </div>
                    </li>
                    <li>
                        <a href="javascript:void(0)" class="btn-help">Help</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
    </nav>


    <div class="container container-content">
        <div class="row row-vis">
            <div class="col-md-8 map-container">
                <div style="min-height: 37px">
                <!--
                    This is where you list all of the variables you want to see
                    in the dropdown list. You don't have to list everything here.
                    For example, you might want to not explicitly show raw numbers
                    or accuracy information.

                    Note this is in a seemingly useless div because if it doesn't
                    have a container with a height the map repositions after the
                    chosen control shows up on page load, consequently pissing me
                    off.
                 -->
                    <select id="metric" name="metric" class="form-control chosen-select hide">
                        <optgroup label="Character">
                            <option value="r1">
                                Area
                            </option>
                            <option value="m2">
                                Median Age of Residents
                            </option>
                        </optgroup>
                        <optgroup label="Economics">
                        </optgroup>
                        <optgroup label="Education">
                        </optgroup>
                        <optgroup label="Engagement">
                        </optgroup>
                        <optgroup label="Environment">
                            <option value="m10">
                                Commuters Driving Alone
                            </option>
                            <option value="m4">
                                Impervious Surface
                            </option>
                            <option value="m3">
                                Tree Canopy
                            </option>
                        </optgroup>
                        <optgroup label="Health">
                        </optgroup>
                        <optgroup label="Housing">
                            <option value="m8">
                                Building Permits for New Construction
                            </option>
                            <option value="m9">
                                Building Permits for Renovation
                            </option>
                            <option value="m6">
                                Housing Unit Size
                            </option>
                            <option value="m5">
                                Housing Density
                            </option>
                            <option value="m7">
                                Year Housing Constructed / Age
                            </option>
                        </optgroup>
                        <optgroup label="Safety">
                        </optgroup>
                    </select>
                </div>
                <div id="map"></div>
                <div class="form mapsearch">
                    <label for="searchbox" class="sr-only">search the map</label>
                    <input id="searchbox" name="searchbox" type="text" class="typeahead form-control" placeholder="search map">
                </div>
                <div class="row">
                    <div class="col-md-5 col-xs-6">
                        <div class="yearDisplay temporal time">
                            <button type="button" class="btn btn-primary btn-looper">
                                <span class="glyphicon glyphicon-play"></span>
                            </button>
                            <div class="slider"></div>
                        </div>
                    </div>
                    <div class="col-md-7 col-xs-6 text-right">
                        <div class="btn-group datatoggle text-right">
                            <button type="button" class="btn btn-default btn-sm toggle-map">Show Map</button>
                            <!-- <button type="button" class="btn btn-default btn-sm report-launch disabled">Report</button> -->
                            <button type="button" class="btn btn-default btn-sm select-clear">Clear Selected</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4 map-aside">
                <div class="meta-subtitle text-center"></div>
                <div class="stats">
                    <div class="row text-center">
                        <div class="col-md-6 col-xs-6 stat-box stat-box-neighborhood"></div>
                        <div class="col-md-6 col-xs-6 stat-box stat-box-county"></div>
                    </div>
                </div>
                <div id="barChart">
                    <svg width="100%" height="100%" class="chart barchart">
                        <g class="barchart-container">
                            <g class="bar-container"></g>
                            <g class="value-mean">
                                <line></line>
                                <text class="mean-text"></text>
                            </g>
                            <g class="value-hover"></g>
                            <g class="value-select"></g>
                            <g class="x axis"></g>
                            <g class="y axis">
                                <text transform="rotate(-90)" y="6" dy=".71em" style="text-anchor: end; opacity: 0;">Neighborhoods</text>
                            </g>
                        </g>
                    </svg>
                </div>
                <div class="text-center chartLegend">
                    <img src="images/legend-median.svg" style="height: 8px;"> Median <span class="median"></span>
                </div>
                <div class="lineChart-container">
                    <canvas id="lineChart" class="temporal"></canvas>
                    <div class="chartLegend lineChartLegend temporal text-center"></div>
                </div>
                <div class="text-center social-links">
                    <p>
                        <a href="javascript:void(0)" data-url="https://twitter.com/intent/tweet?tw_p=tweetbutton&url="><i class="icon-twitter-bird" title="Share on Twitter"></i></a>
                        <a href="javascript:void(0)" data-url="http://www.facebook.com/sharer.php?u="><i class="icon-facebook-rect" title="Share on Facebook"></i></a>
                        <a href="javascript:void(0)" data-url="https://plus.google.com/share?url="><i class="icon-googleplus-rect" title="Share on Google+"></i></a>
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8 datatable-container"></div>
        </div>
        <div class="row meta-container">
            <div class="col-md-8">
                <div class="well meta-joyride">
                    <h4>Why This is Important</h4>
                    <div class='meta-important'></div>
                </div>
                <div class="well">
                    <h4>Additional Resources</h4>
                    <div class='meta-resources'></div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="well">
                    <h4>About the Data</h4>
                    <div class='meta-about'></div>
                </div>
            </div>
        </div>
        <div class="row">
            <footer class="text-center page-footer">
                <p>
                    <img src="images/seals.png" width="177" height="36" alt="City and County Seals">
                </p>
                <p class="text-muted">
                    Created by the <a href="http://charmeck.org/city/charlotte/Pages/default.aspx">City of Charlotte</a>, <a href="http://charmeck.org/mecklenburg/county/Pages/Default.aspx">Mecklenburg County</a>, and <a href="http://www.uncc.edu/">UNCC</a>
                    &bull; Source code on <a href="https://github.com/tobinbradley/Mecklenburg-County-Quality-of-Life-Dashboard">Github</a>
                </p>
            </footer>
        </div>
    </div>

    <!-- BEGIN: Underscore Template Definitions -->
    <script type="text/template" class="template-table">
        <% if (rc.theSelected.length > 0) {
            var m = model.metricId;
            %>
        <div class="div-scroll">
            <table class="table table-condensed">
                <thead>
                  <tr>
                    <th class="text-center"><a href="javascript:void(0)" tabindex="0" class="meta-definition" data-toggle="popover" data-title="Neighborhood Profile Area"
                        data-content="Neighborhood Profile Areas (NPAs) are geographic areas used for the organization and presentation of data in the Quality of Life Study. The boundaries were developed with community input and are based on one or more Census block groups.">
                        NPA</a></th>
                    <th class="text-right">Value</th>
                    <th class="text-left"></th>
                    <th class="text-center"><% if (metricAccuracy.indexOf(model.metricId) !== -1) { %><a href="javascript:void(0)" tabindex="0" class="meta-definition" data-toggle="popover" data-title="Margin of Error"
                            data-content="Margin of error (MOE) is an indicator of reliability for data that comes from the American Community Survey (ACS). The ACS is mailed to only a small percentage of households, and because not all households are surveyed, the data are only estimates.">
                            MOE<% } %></th>
                    <th class="text-center"><% if (rc.keys.length > 2) { %>Change<br><%= getYear(rc.keys[1]) + "-" + getYear(rc.keys[rc.keys.length - 1]) %><% } %></th>
                    <th class="text-right"><% if (metricSummable.indexOf(getRaw(m)) !== -1) { %>Number<% } %></th>
                    <th class="text-left"></th>
                    <th class="text-center"><% if (rc.keys.length > 2 && metricSummable.indexOf(getRaw(m)) !== -1) { %>Change<br><%= getYear(rc.keys[1]) + "-" + getYear(rc.keys[rc.keys.length - 1]) %><% } %></th>
                  </tr>
                </thead>
                <tbody>
                <%
                _.each(rc.theSelected, function (d, i) { %>
                    <tr data-id="<%- d.id %>" <% if (d[rc.keys[model.year + 1]]) { %>data-value="<%- d[rc.keys[model.year + 1]] %>"<% } %> class="metric-hover">
                        <td class="text-center"><%- d.id %></td>
                        <td class="text-right datatable-value  td-border-left"><%= dataPretty(d[rc.keys[model.year + 1]], m) %></td>
                        <td class="text-left"><% if (metricUnits[model.metricId]) { %><%= metricUnits[model.metricId] %><% } %></td>
                        <td class="text-center"><% if (metricAccuracy.indexOf(model.metricId) !== -1) { %>&#177;<%= dataPretty(rc.theAccuracy[i][rc.keys[model.year + 1]], m) %><% } %></td>
                        <td class="text-center"><% if (rc.keys.length > 2) { %><%= getTrend(d[rc.keys[rc.keys.length - 1]], d[rc.keys[1]]) %><% } %></td>
                        <td class="text-right td-border-left"><% if (metricSummable.indexOf(getRaw(m)) !== -1) { %><%= dataPretty(rc.theRaw[i][rc.keys[model.year + 1]], getRaw(m)) %><% } %></td>
                        <td class="text-left"><% if (hasRaw(model.metricId) && metricUnits[getRaw(model.metricId)]) { %><%= metricUnits[getRaw(m)] %><% } %></td>
                        <td class="text-center"><% if (rc.keys.length > 2 && hasRaw(model.metricId) && metricSummable.indexOf(getRaw(m)) !== -1) { %><%= getTrend(rc.theRaw[i][rc.keys[rc.keys.length - 1]], rc.theRaw[i][rc.keys[1]]) %><% } %></td>
                    </tr>
                <% }); %>
                </tbody>
            </table>
        </div>
        <p class="text-right">
            <button type="button" class="btn btn-default btn-sm table2CSV">Download as CSV</button>
        </p>
        <% } %>
    </script>

    <script type="text/template" class="template-statbox">
        <span class="header"><%= rc.topText %></span>
        <h3 class="stat-mean"><%= rc.mainNumber %></h3>
        <% if (rc.mainUnits) { %>
            <span class="stat-units"><%= rc.mainUnits %></span>
        <% } %>
        <% if (rc.rawTotal) { %>
            <span class="stat-total">
                <%= rc.rawTotal %>
                <% if (rc.rawUnits) { %><%= rc.rawUnits %><% } %>
            </span>
        <% } %>
    </script>
    <!-- END: Underscore Template Definition. -->

    <!-- Begin jQuery Tourbus -->
    <ol class='tourbus-legs' id='dashboard-tour'>
      <li data-orientation='centered' data-width='300'>
        <h3>Welcome!</h3>
        <p>The Quality of Life Dashboard is designed to help assess the health of neighborhoods in Charlotte and Mecklenburg County.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.chosen-container' data-orientation='bottom' data-width='300'>
        <h3>Metrics</h3>
        <p>Use this control to select the <strong>Metric</strong> you're interested in.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='#map' data-orientation='bottom' data-width='300'>
        <h3>Map</h3>
        <p>The <strong>Map</strong> is fully interactive - you can pan, zoom, and select neighborhoods by mouse or touch.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='#searchbox' data-orientation='bottom' data-width='300'>
        <h3>Search</h3>
        <p>The <strong>Search</strong> control lets you search for almost anything. Type in a neighborhood number, the first part of an address, or a place name, and select a match using your mouse, keyboard, or by touch.</p>
        <p>Ex: Try typing <strong>700 n</strong></p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.yearDisplay' data-orientation='top' data-width='300'>
        <h3>Year</h3>
        <p>The <strong>Year</strong> controls let you control the year being shown on the map and in the <strong>Bar Chart</strong>.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.datatoggle' data-orientation='top' data-width='300'>
        <h3>Data Controls</h3>
        <p>Use these buttons to toggle the base map, show the data table, clear any selected neighborhoods, or create a report if you have one or more neighborhoods selected.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.stat-box-neighborhood' data-orientation='bottom' data-width='300'>
        <h3>Average</h3>
        <p>The <strong>Average</strong> for County NPA's and any selected NPA's is shown here. The County NPA Average is indicated by a dashed line on the charts.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.barchart' data-orientation='bottom' data-width='300'>
        <h3>Bar Chart</h3>
        <p>The <strong>Bar Chart</strong> shows a lot of information about the <strong>Metric</strong>. First, it acts as a legend for the map - the map colors correspond to the the chart colors. It also shows you the density of the data - the taller the <em>quantile</em>, or bar, the more neighborhoods exist in that range.</p>
        <p>The dashed line represents the average value of the neighborhoods.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.lineChart-container' data-orientation='top' data-width='300'>
        <h3>Line Chart</h3>
        <p>The <strong>Line Chart</strong> shows the trend of the metric over time. The dashed line represents the average value of the neighborhoods.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-stop">Finished</button>
          <button type="button" class="btn btn-default btn-sm btn-sm tourbus-next">Next</button>
        </div>
      </li>
      <li data-el='.meta-joyride' data-orientation='top' data-width='300'>
        <h3>Metric Information</h3>
        <p>The bottom of the page shows more information about the metric, including a brief description, why it is important, where the data came from, and additional resources.</p>
        <div class="btn-group pull-right">
          <button type="button" class="btn btn-default btn-sm tourbus-prev">Previous</button>
          <button type="button" class="btn btn-default btn-sm tourbus-stop">Finished</button>
        </div>
      </li>
    </ol>
    <!-- End jQuery Tourbus -->

    <!-- scripts at the bottom yo -->
    <script src="js/main.js?foo=95049"></script>

    <!--   Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-48797957-1', 'mcmap.org');
      ga('send', 'pageview');
    </script>

</body>

</html>
